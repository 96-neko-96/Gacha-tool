# 🎰 VTuberガチャツール

VTuber配信用のカテゴリベースランダムコンテンツ生成ツールです。Google Gemini APIを使用して、罰ゲームやネタを重複を避けながらAI生成します。

## ✨ 主な機能

- 📂 **CSV形式でカテゴリ管理** - 独自のカテゴリとプロンプトを簡単に追加
- 🎲 **ランダム抽選** - 選択したカテゴリからランダムに1つを選んでAI生成
- 🔄 **重複チェック** - 過去の生成結果との類似度を判定し、重複を回避
- 📜 **履歴管理** - 過去50件まで自動保存、いつでも見返せる
- 🎨 **レスポンシブデザイン** - デスクトップ・タブレット・スマホ対応
- ⚙️ **柔軟な設定** - APIキー、モデル選択、カスタムモデル追加

## 🚀 クイックスタート

### 1. ファイルを開く

`index.html` をブラウザで開いてください。インターネット接続が必要です。

### 2. APIキーを設定

1. 右上の「⚙️ 設定」ボタンをクリック
2. [Google AI Studio](https://aistudio.google.com/app/apikey) でAPIキーを取得
3. APIキー欄に貼り付けて「保存」

> ⚠️ **注意**: APIキーはブラウザのLocalStorageに平文で保存されます。セキュリティ上、個人使用に限定してください。

### 3. カテゴリを読み込む

1. 「📄 CSVを読み込む」ボタンをクリック
2. `sample_categories.csv` または独自のCSVファイルを選択
3. カテゴリにチェックを入れる（複数選択可）

### 4. ガチャを回す！

中央の「ガチャを回す！」ボタンをクリックすると、AIが罰ゲームやネタを生成します。

## 📝 CSVファイル形式

CSVファイルは以下の形式で作成してください：

```csv
カテゴリ名,プロンプト
語尾縛り,配信中に使える面白い語尾縛りを一つ提案してください
話し方縛り,配信で実施できるユニークな話し方縛りを一つ提案してください
```

### ポイント

- 1行目: ヘッダー（`カテゴリ名,プロンプト`）
- 2行目以降: カテゴリ名とプロンプトをカンマ区切り
- プロンプトにカンマが含まれていてもOK
- UTF-8エンコーディング推奨

## 🎯 使用例

### 配信での活用方法

1. **視聴者参加型企画**
   - スパチャ金額に応じてガチャを回す
   - チャンネル登録者数の節目で実施

2. **定期コンテンツ**
   - 配信開始時の恒例ネタ
   - 週1回のチャレンジ企画

3. **コラボ配信**
   - メンバー全員でガチャを回して一緒に実施
   - 罰ゲーム要素として使用

## ⚙️ 詳細設定

### モデルについて

- **デフォルト**: `gemini-2.0-flash-exp`（高速・最新）
- **追加可能**: Geminiの他のモデルも設定可能
- **カスタムモデル**: 設定画面から追加・削除

### 重複チェックの仕組み

- **完全一致**: 大文字小文字を区別せず判定
- **部分一致**: Levenshtein距離で70%以上の一致を検出
- **類似度80%以上**: 警告を表示し、再生成を促す

### データ保存

すべてのデータはブラウザのLocalStorageに保存されます：

- APIキー
- モデル設定
- 生成履歴（最大50件）
- 重複チェックデータ

> 💡 ブラウザのキャッシュをクリアするとデータが消えます。必要に応じてバックアップしてください。

## 🔒 セキュリティ注意事項

- APIキーは平文でLocalStorageに保存されます
- 他人がアクセスできる環境では使用しないでください
- APIキーの定期的な再生成を推奨します
- 本番環境での使用には適切なセキュリティ対策が必要です

## 🐛 トラブルシューティング

### ガチャが回せない

- APIキーが正しく設定されているか確認
- カテゴリが1つ以上選択されているか確認
- ブラウザのコンソールでエラーを確認

### CSVが読み込めない

- ファイル形式が正しいか確認（UTF-8、カンマ区切り）
- ヘッダー行が含まれているか確認
- 各行に「カテゴリ名」と「プロンプト」の2つの要素があるか確認

### 履歴が保存されない

- ブラウザのLocalStorageが有効か確認
- プライベートブラウジングモードでは保存されません
- LocalStorageの容量制限（約5MB）を超えていないか確認

### API呼び出しエラー

- インターネット接続を確認
- APIキーが有効か確認
- Gemini APIの利用制限に達していないか確認

## 📊 データ構造

### LocalStorage

```javascript
// APIキー
gemini_api_key: "YOUR_API_KEY"

// モデルリスト
gemini_models: ["gemini-2.0-flash-exp", "gemini-1.5-pro"]

// 選択中のモデル
selected_model: "gemini-2.0-flash-exp"

// 生成履歴
generation_history: [
  {
    category: "語尾縛り",
    result: "全ての文末を「～ぴえん」で終わらせる",
    timestamp: "2025-01-01T12:00:00Z",
    model: "gemini-2.0-flash-exp"
  }
]

// 重複チェックデータ
duplicate_check: {
  "語尾縛り": [
    { result: "～ぴえん", hash: "abc123" }
  ]
}
```

## 🛠️ 技術スタック

- **HTML5** - セマンティックマークアップ
- **CSS3** - アニメーション、グラデーション、レスポンシブデザイン
- **Vanilla JavaScript** - フレームワーク不使用、純粋なJavaScript
- **Google Gemini API** - AI生成エンジン
- **LocalStorage** - クライアント側データ永続化

## 📜 ライセンス

このプロジェクトはMITライセンスの下で公開されています。詳細は`LICENSE`ファイルを参照してください。

## 🤝 コントリビューション

バグ報告、機能提案、プルリクエストを歓迎します！

## 📞 サポート

問題が発生した場合は、GitHubのIssuesでお知らせください。

---

**Enjoy streaming! 🎉**
